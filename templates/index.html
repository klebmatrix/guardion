<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAINEL GUARDION | OMNI AGENT</title>
    <style>
        :root { --bg: #020617; --card: #0f172a; --accent: #3b82f6; --text: #f1f5f9; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; padding: 20px; }
        header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #1e293b; padding-bottom: 20px; margin-bottom: 30px; }
        .logo { font-size: 24px; font-weight: 800; color: var(--accent); }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; }
        .card { background: var(--card); border: 1px solid #1e293b; border-radius: 16px; padding: 20px; position: relative; }
        .card h2 { margin-top: 0; color: var(--accent); font-size: 18px; border-bottom: 1px solid #1e293b; padding-bottom: 10px; }
        .label { font-size: 12px; font-weight: bold; background: #1e293b; padding: 4px 8px; border-radius: 6px; color: #94a3b8; margin-bottom: 15px; display: inline-block; }
        
        .saldos-box { margin: 15px 0; font-family: monospace; }
        .saldo-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dashed #1e293b; }
        .val { font-weight: bold; color: #10b981; }

        .btn { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 15px; }
        .btn-wbtc { background: #f7931a; color: white; }
        .btn-usdt { background: #26a17b; color: white; }
        .btn-multi { background: #6366f1; color: white; }
        .btn:hover { opacity: 0.8; transform: translateY(-2px); }
        
        .logout { color: #ef4444; text-decoration: none; font-weight: bold; }
        #status-global { padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; color: var(--accent); margin-bottom: 20px; display: none; }
    </style>
</head>
<body>

<header>
    <div class="logo">üõ°Ô∏è GUARDION OMNI</div>
    <a href="/logout" class="logout">SAIR DO SISTEMA</a>
</header>

<div id="status-global"></div>

<div class="grid">
    <div class="card" id="card-MOD_01">
        <span class="label">ESTRAT√âGIA: AC√öMULO DE BITCOIN</span>
        <h2>M√ìDULO 01 (WBTC)</h2>
        <div class="saldos-box">
            <div class="saldo-item"><span>USDC:</span> <span class="val" id="usdc-MOD_01">0.00</span></div>
            <div class="saldo-item"><span>WBTC:</span> <span class="val" id="wbtc-MOD_01">0.00</span></div>
            <div class="saldo-item"><span>POL (GAS):</span> <span class="val" id="pol-MOD_01">0.00</span></div>
        </div>
        <button class="btn btn-wbtc" onclick="executar('MOD_01')">CONVERTER USDC ‚ûî WBTC</button>
    </div>

    <div class="card" id="card-MOD_02">
        <span class="label">ESTRAT√âGIA: DOLARIZA√á√ÉO</span>
        <h2>M√ìDULO 02 (USDT)</h2>
        <div class="saldos-box">
            <div class="saldo-item"><span>USDC:</span> <span class="val" id="usdc-MOD_02">0.00</span></div>
            <div class="saldo-item"><span>USDT:</span> <span class="val" id="usdt-MOD_02">0.00</span></div>
            <div class="saldo-item"><span>POL (GAS):</span> <span class="val" id="pol-MOD_02">0.00</span></div>
        </div>
        <button class="btn btn-usdt" onclick="executar('MOD_02')">CONVERTER USDC ‚ûî USDT</button>
    </div>

    <div class="card" id="card-MOD_03">
        <span class="label">ESTRAT√âGIA: DIVERSIFICA√á√ÉO</span>
        <h2>M√ìDULO 03 (MULTI)</h2>
        <div class="saldos-box">
            <div class="saldo-item"><span>USDC:</span> <span class="val" id="usdc-MOD_03">0.00</span></div>
            <div class="saldo-item"><span>DIVERSIFICADO:</span> <span class="val" id="multi-MOD_03">SIM</span></div>
            <div class="saldo-item"><span>POL (GAS):</span> <span class="val" id="pol-MOD_03">0.00</span></div>
        </div>
        <button class="btn btn-multi" onclick="executar('MOD_03')">DIVERSIFICAR CARTEIRA</button>
    </div>
</div>



<script>
    async function carregarSaldos() {
        const response = await fetch('/saldos');
        const dados = await response.json();
        
        for (const mod in dados) {
            if (document.getElementById(`pol-${mod}`)) {
                document.getElementById(`pol-${mod}`).innerText = dados[mod].pol;
                document.getElementById(`usdc-${mod}`).innerText = dados[mod].usdc;
                if (dados[mod].wbtc) document.getElementById(`wbtc-${mod}`).innerText = dados[mod].wbtc;
                if (dados[mod].usdt) document.getElementById(`usdt-${mod}`).innerText = dados[mod].usdt;
            }
        }
    }

    async function executar(modulo) {
        const status = document.getElementById('status-global');
        status.style.display = 'block';
        status.innerText = `‚è≥ Solicitando convers√£o para ${modulo}...`;

        const response = await fetch('/converter', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({modulo: modulo})
        });

        const r = await response.json();
        if (r.status === 'sucesso') {
            status.innerText = `‚úÖ ${r.msg} | Hash: ${r.hash.substring(0,15)}...`;
            carregarSaldos();
        } else {
            status.innerText = `‚ùå Erro na opera√ß√£o.`;
        }
    }

    setInterval(carregarSaldos, 10000); // Atualiza a cada 10 segundos
    carregarSaldos();
</script>
</body>
</html>